# 🛒 ECサイト（Portfolio Version）

**生活雑貨 EC サイト** のポートフォリオ公開用リポジトリです。  
認証、商品管理、在庫管理、カート、決済、画像アップロード、テストコード（一部）などの最低限必要な基本機能を実装しています。  
オブジェクト指向の理解が主目的のため、フレームワークは使用せず、**素のPHP**で MVC構成・独自Routerを実装しています。  
テストコードも初めて実装しましたが、テストしにくい構造になっている為、途中迄です（依存注入もクラスによってマチマチです、、、）  
※補足：要所要所でChatGPTのアドバイス・レビューを貰いながら進めました。


## 公開URL : <a href="https://portfolio-sh0212.com/ecsite/" target="_blank">https://portfolio-sh0212.com/ecsite/</a>

---

## 🚀 特徴 / 実装機能

### 🔐 認証機能
- ユーザー / オーナー / 管理者（複数ガード）
- メール認証
- 2段階認証 （メール送信は実装までは行っていますが、サイト訪問者様のプライバシーを考慮し画面表示で代替えしています）
- 登録済のダミーユーザーは以下の通りです

  | ユーザー | メールアドレス | password | ログインURL |
  |----------|---------|---------|---------|
  | ユーザー | user@mail.com | user123 | <a href="https://portfolio-sh0212.com/ecsite/login" target="_blank">ユーザーログイン画面</a>
  | オーナー | owner1@mail.com ～ owner5@mail.com | owner123 (共通) | <a href="https://portfolio-sh0212.com/ecsite/owner/login" target="_blank">オーナーログイン画面</a>
  | 管理者 | admin@mail.com | admin123 | <a href="https://portfolio-sh0212.com/ecsite/admin/login" target="_blank">管理者ログイン画面</a>
---
### ⚙️ サイト管理者機能
- オーナー登録・編集・削除
- カテゴリー登録・編集

### 🏪 出展者（オーナー）機能
- 商品登録（画像アップロード対応・Intervention Image）
- 商品編集 / 削除
- 商品画像の複数枚管理（並び順、更新、削除）
- 在庫管理（入庫・在庫数管理）
- 店舗プロフィール編集

---

### 🛍 ユーザー機能
- 商品一覧（絞り込み・検索・ページネーション・並び替え）
- お気に入り機能（Ajax）
- カート機能（Ajax）
- 注文確認
- Stripe Checkout による決済処理
- 決済ステータスに応じたメール通知　※Mailtrapへ送信

---

### 💳 決済（Stripe）
- Stripe Checkout の実装
- Stripe Webhook（決済完了イベント受信）
- 「決済成功・キャンセル」画面
- Webhook イベントの DB 保存（ログ）

---

### 🗂 カテゴリー構造
- 親カテゴリ → サブカテゴリ → 商品カテゴリの 3 階層
- JOIN + PHP 整形による出力
- ツリー構造生成の最適化

---

### 🖼 画像アップロード
- Intervention Image を利用した画像加工
- 一時保存（tmp） → 最終保存のフロー
- 削除・更新・並び順変更に対応

---

### 🧪 テストコード
- PHPUnit
- Unit テスト（バリデーション / サービスロジックの一部）

---

## 🏗 技術スタック
- **使用言語** PHP
- **開発環境:** Docker
- **フロントエンド:**  Html / CSS / JavaScript 
- **データベース:** MySQL
- **画像関連:** Intervention Image / SortableJS / Swiper
- **決済:** Stripe sandbox（Checkout + Webhook）
- **テスト:** PHPUnit
- **メール:** Mailtrap
- **その他:** 公開用清掃スクリプト（clean.sh）

---

## 🧹 公開用に削除した主なもの

本リポジトリはポートフォリオ用にクリーンアップ済で、以下は含まれていません。

- アップロード画像（ダミー商品画像 / ダミーショップ画像）  
- テスト実行結果キャッシュ

---

## ➡️ 今後の予定

### リファクタリング
- 簡易DIの導入
- 例外取得・エラー処理の構造見直し
- 静的メソッドの見直し

> 拡張及びテストが容易な構成に再構築することが先決かと思っています。。。